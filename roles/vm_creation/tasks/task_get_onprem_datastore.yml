---
# tasks to define the on-prem datastore for each host
- name: define on-prem datastores list for each host group
  set_fact:
    vm_ds_names: "{{ hostvars[groups[('dr' if 'dr' in group_names else '') + 'vcenter']|first][inventory_hostname[:-2] + '_ds_names'] }}"
  tags: vm_creation

- block:
  - name: define on-prem datastore for each host
    set_fact:
      vm_ds: "{{ vm_ds_names|select('search', '-02')|list|join if inventory_hostname[-2:]|int % 2 == 0 else vm_ds_names|select('search', '-01')|list|join }}"
  when: "'dr' not in group_names"
  tags: vm_creation

- block:
  - name: define on-prem datastore for each DR host
    set_fact:
      vm_ds: "{{ vm_ds_names|last }}"
  when: "'dr' in group_names"
  tags: vm_creation
