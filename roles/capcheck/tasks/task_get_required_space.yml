---
# tasks to get the total storage space required
- block:
  - name: define total required space
    set_fact:
      required_space: "{{required_space|default(0)|int + hostvars[task_item]['vm']['disk']|int + hostvars[task_item]['vm']['memory']|int}}"
    loop: "{{groups['stack']}}"
    loop_control:
      loop_var: task_item

  - debug:
      msg:
        - "Total system required storage space: {{(required_space|float / 1024)|string + ' TiB' if (required_space|int)|string|length > 3 else required_space|string + ' GiB'}}"
  tags: ['capcheck', 'vm_creation']
