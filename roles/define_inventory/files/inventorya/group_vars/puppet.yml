---
# Variables for puppet hosts
ssh_username: "{{ hostvars[groups['bastion'][0]]['ansible_user'] if (groups['bastion'][0] is defined and bastion.address != []) else '' }}"
ssh_address: "{{ hostvars[groups['bastion'][0]]['ansible_host'] if (groups['bastion'][0] is defined and bastion.address != []) else '' }}"
ssh_var: '-o ProxyCommand="ssh -W %h:%p -q {{ ssh_username }}@{{ ssh_address }}"'
ansible_ssh_common_args: "{{ ssh_var if (groups['bastion'] | length >= 1 and bastion.address != []) else '' }}"

ansible_user: "{{ 'cmsbuild' if (puppet.vmname is search('01') or puppet.vmname is search('02')) else 'root'  }}"
ansible_ssh_pass: "{{ PUPP_PASS|default('') if (puppet.vmname is search('01') or puppet.vmname is search('02')) else NONEM7_PASS  }}"
ansible_become_pass: "{{ ansible_ssh_pass }}"
ansible_host: "{{ puppet.fqdn }}"
