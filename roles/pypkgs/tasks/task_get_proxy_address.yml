---
# Tasks to define the proxy address
- block:
  - name: get proxy setting
    shell: grep -r "^proxy.*=.*ht" /etc/environment /etc/profile ~/.bashrc ~/.bash_profile | cut -d '"' -f2 | uniq
    register: proxy_string
    check_mode: no

  - name: define proxy_address
    set_fact:
      proxy_address: "{{ proxy_string.stdout }}"

  delegate_to: "{{ host_delegate|default('localhost') }}"
  run_once: true
  tags: [ 'always', 'pypkgs' ]
