---
# Tasks for vm_facts
- block:
  - include_tasks: task_define_vm_ip.yml
  - include_tasks: task_define_hosts_variables.yml
    when: configure_vms | default(false) | bool
  when:
    - inventory_hostname in groups['stack'] or (inventory_hostname in groups['dr'] and customer.disaster_recovery)
    - (deploy | default(false) | bool) or (rollback | default(false) | bool)
  tags: always
