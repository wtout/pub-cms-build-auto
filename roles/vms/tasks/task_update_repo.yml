---
# tasks to create yum repos on VM
- block:
  - name: Create the ym repositories
    yum_repository:
      name: "{{repo_item.name}}"
      baseurl: "{{repo_item.baseurl}}"
      description: "{{repo_item.description}}"
      enabled: "{{repo_item.enabled}}"
      file: "{{repo_item.file}}"
      gpgcheck: "{{repo_item.gpgcheck}}"
      sslverify: "{{repo_item.sslverify}}"
      state: "{{repo_item.state}}"
    loop:
      - { name: 'QuickSilver_Packages', baseurl: "{{repo.baseurl}}/{{customer.release}}", description: 'QuickSilver Packages repo', enabled: yes, file: 'qs_repo', gpgcheck: no, sslverify: no, state: 'present' }
      - { name: 'QS-PROD', baseurl: "{{repo.baseurl}}/QS", description: 'Production repo', enabled: yes, file: 'QS', gpgcheck: no, sslverify: no, state: 'present' }
    loop_control:
      loop_var: repo_item
  become: "{{true if 'em7' in group_names else false}}"
  tags: vms
