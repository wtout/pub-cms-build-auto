---
# tasks to rename nic2 on the EM7 VMs
- block:
  - name: Set ens224 down
    ansible.builtin.command: |
      ip link set ens224 down
    register: int_down
    failed_when: int_down.rc == 1 and int_down.stderr is not search('Cannot find device')
  - name: rename nic2 on the VM
    ansible.builtin.command: |
      ip link set ens224 name ens192
    register: int_rename
    failed_when: int_rename.rc == 1 and int_rename.stderr is not search('Cannot find device')
  - name: Set ens192 up
    ansible.builtin.command: |
      ip link set ens192 up
  - name: restart network
    systemd:
      name: network
      state: restarted
      daemon_reload: yes
  become: "{{ true if ansible_user != 'root' else false }}"
  tags: vm_creation
